<%- include('partials/top-pane') %>


<!-- Main Content -->
<main class="min-h-screen hero-pattern pt-20 pb-24">
    <!-- Background Elements -->
    <div class="fixed inset-0 overflow-hidden pointer-events-none">
        <div class="floating-animation absolute top-20 left-10 w-72 h-72 bg-blue-500 rounded-full opacity-5 blur-3xl"></div>
        <div class="floating-animation absolute bottom-20 right-10 w-96 h-96 bg-purple-500 rounded-full opacity-5 blur-3xl" style="animation-delay: -3s;"></div>
    </div>

    <div class="relative z-10 max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <% if (posts && posts.length > 0) { %>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <% posts.forEach(function(post, index) { %>
                    <div class="post-card rounded-2xl border border-gray-700 overflow-hidden relative group grid-fade-in"
                         style="animation-delay: <%= (index * 0.1) %>s;">
                        
                        <div class="post-image-container aspect-[4/3] relative overflow-hidden">
                            <img
                                src="/images/uploads/<%= post.picture %>"
                                alt="<%= post.caption || 'Post image' %>"
                                class="post-image w-full h-full object-cover object-center"
                                loading="lazy"
                            />
                            
                            <!-- Gradient overlay for text readability -->
                            <div class="absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent"></div>
                            
                            <!-- Post Content Overlay -->
                            <div class="absolute bottom-0 left-0 right-0 p-4">
                                <div class="flex flex-col justify-end h-full">
                                    <div>
                                        <% if (post.caption) { %>
                                            <h3 class="text-lg font-bold text-white mb-2 line-clamp-2"><%= post.caption %></h3>
                                        <% } %>
                                        <!-- User Info -->
                                        <span class="text-sm font-medium text-white/90">@<%= post.user.username %></span>
                                    </div>
                                </div>
                            </div>

                            <!-- Pin Button -->
                            <button 
                                class="pin-btn absolute top-3 right-3 w-8 h-8 rounded-full flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity"
                                data-post-id="<%= post.id || post._id %>"
                                onclick="togglePin(this)">
                                <% if (user && user.pinned && user.pinned.includes(post.id || post._id)) { %>
                                    <i class="ri-pushpin-fill text-lg text-blue-400"></i>
                                <% } else { %>
                                    <i class="ri-pushpin-line text-lg"></i>
                                <% } %>
                            </button>
                        </div>
                    </div>
                <% }); %>
            </div>
        <% } else { %>
            <!-- No Posts Message -->
            <div class="no-posts">
                <div class="w-24 h-24 bg-gray-800 rounded-full flex items-center justify-center mx-auto mb-4">
                    <i class="ri-image-line text-4xl text-gray-600"></i>
                </div>
                <h3 class="text-xl font-semibold text-gray-400 mb-2">No posts yet</h3>
                <p class="text-gray-500">Be the first to share something amazing!</p>
            </div>
        <% } %>
    </div>
</main>
include('partials/bottom-pane') %>
